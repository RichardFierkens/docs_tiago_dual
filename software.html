

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Software Structure &mdash; TiagoDual docs 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=2709fde1"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Hardware" href="hardware.html" />
    <link rel="prev" title="Using TiagoDual" href="usage.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            TiagoDual docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="usage.html">Using TiagoDual</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Software Structure</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#docker-container">Docker container</a></li>
<li class="toctree-l2"><a class="reference internal" href="#simulation">Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-map">Create map</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pick-and-place-mission">Pick and Place mission</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hardware.html">Hardware</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TiagoDual docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Software Structure</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/software.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="software-structure">
<h1>Software Structure<a class="headerlink" href="#software-structure" title="Link to this heading"></a></h1>
<p>The package from <code class="docutils literal notranslate"><span class="pre">PAL</span> <span class="pre">Robotics</span></code> are provided in <cite>/opt/pal/alum/share/</cite>. In here are the packages presented. Most of the packages only provided launch files and config files. Those files can only be editted as sudo. The basic functions consist of the following packages:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tiago_dual_bringup</span></code>: Launches all the needed configs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tiago_dual_description</span></code>: Provides the definition of the Tiago model, the meshes and also the physical constraints.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tiago_dual_gazebo</span></code>: This launches gazebo in a fixed world from PAL with the Tiago model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tiago_dual_moveit_config</span></code>: Houses all the information about the manipulators and controllers. This package is needed if you want to move Moveit2 for controlling the manipulators.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pmb2_2dnav</span></code>: Houses the navigation for the Tiago that determine the best route and update to the current environmental situation.</p></li>
</ul>
</div></blockquote>
<section id="docker-container">
<h2>Docker container<a class="headerlink" href="#docker-container" title="Link to this heading"></a></h2>
<p>A Docker container is available from PAL Robotics. This container includes all the provided software packages and simulation worlds. These are client-specific. In other words, when you buy a robot from PAL Robotics, they provide you with the necessary software. With this container, you can work with Tiago as you would in real life.</p>
<p>First you need to do is download the docker file. Download it from <strong>LINK!!!</strong> Then create the Docker container with the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bash</span> <span class="o">&lt;</span><span class="n">client</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;-</span><span class="n">build</span><span class="o">-</span><span class="n">docker</span><span class="o">.</span><span class="n">sh</span> <span class="o">--</span><span class="n">create</span>
</pre></div>
</div>
<p>The create container can be started with the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">start</span> <span class="o">-</span><span class="n">ai</span> <span class="n">tiago</span><span class="o">-</span><span class="n">dual</span><span class="o">-</span><span class="mi">115</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
<p>Now you are in the docker container called the <cite>Development Docker</cite> from PAL. To run all the simulation code, make sure you are running it in the docker container. The Docker container was used for the research assignment because Tiago was unfortunately not working.</p>
</section>
<section id="simulation">
<h2>Simulation<a class="headerlink" href="#simulation" title="Link to this heading"></a></h2>
<p>There is a package that contains a simulation in the supermarket provided by KAS lab. First clone the repository</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">git</span><span class="nd">@github</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="n">RichardFierkens</span><span class="o">/</span><span class="n">tiago_dual_supermarket</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Improvement are needed (17 October 2025) for adjusting the map. But for now do this:</p>
</div>
<p>Now you need to change the path for the map in the file <cite>/opt/pal/alum/share/pal_navigation_cfg/params/nav2_map_server/00_map_server.yaml</cite> with the path of the world of the supermarket located.</p>
<p>After that, the simulation including moveit and nav2 can be run.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ros2</span> <span class="n">launch</span> <span class="n">tiago_planning</span> <span class="n">supermarket_tiago</span><span class="o">.</span><span class="n">launch</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>If you want to make some changes in the coordination of this packages. Feel free to change in the packages.</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>tiago_skills/detect_object_server.cpp</cite>: This provides the vision code. Using an apriltag detector for receiving the object coordinates</p></li>
<li><p><cite>tiago_skills/move_skill_server.cpp</cite>: Here, the moveit is created using MoveGroupInterfaces. So far, here is not really anything needed to change.</p></li>
<li><p><cite>tiago_skills/navigate_skill_server.cpp</cite>: This file make sure that the coordinates for nav2 is working. This files take care of making the Tiago move.</p></li>
<li><p><cite>tiago_skills/pick_place_skill_server.cpp</cite>: This package make sure that the gripper will open and close. In here, an attach_object function is used. this is only needed for the simulation.</p></li>
<li><p><cite>BehaviorTree.ROS2/btcpp_ros2_samples_tiago_dual</cite>: This package provides the behavior tree of the simple pick and place mission.</p></li>
</ul>
</div></blockquote>
</section>
<section id="create-map">
<h2>Create map<a class="headerlink" href="#create-map" title="Link to this heading"></a></h2>
<p>For now (28 October 2025), there are two maps created with SLAM. If you want to create a new map do the following:</p>
<ol class="arabic">
<li><p>Comment in the <cite>supermarket_tiago.launch.py</cite> the two launch arguments
<cite>loc_robot_launch</cite> and <cite>nav2_robot_launch</cite> and uncomment <cite>slam_bringup_launch</cite>.</p></li>
<li><p>Select the world in the same launch file you want to create a map from.</p></li>
<li><p>Launch the file.</p></li>
<li><p>Open rviz and check the /map topic so that you can see the map.</p></li>
<li><p>Open in another terminal:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>teleop_twist_keyboard<span class="w"> </span>teleop_twist_keyboard<span class="w"> </span>cmd_vel:<span class="o">=</span>/cmd_vel
</pre></div>
</div>
</li>
<li><p>When you are done with mapping, save the map to your folder with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>run<span class="w"> </span>nav2_map_server<span class="w"> </span>map_saver_cli<span class="w"> </span>-f<span class="w"> </span>/home/user/maps/AH_store_map<span class="w"> </span><span class="se">\</span>
<span class="w">   </span>--ros-args<span class="w"> </span>-p<span class="w"> </span>image_format:<span class="o">=</span>pgm
</pre></div>
</div>
</li>
<li><p>Now change this .yaml file as described above.</p></li>
</ol>
</section>
<section id="pick-and-place-mission">
<h2>Pick and Place mission<a class="headerlink" href="#pick-and-place-mission" title="Link to this heading"></a></h2>
<p>A simple pick and place mission is created for the Tiago in Gazebo Classic. Before running the simulation, you need to make sure that the collision in the arms of Tiago are disabled. Otherwise a plugin for grasping the object is not possible.</p>
<ol class="arabic">
<li><p>Comment the collision in the <cite>pal_gripper_description/gripper.urdf.xacro</cite> file. Do this for the wrist and arm urdf in the <cite>tiago_description</cite> as well.</p></li>
<li><p>Launch the simulation as before:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>tiago_planning<span class="w"> </span>supermarket_tiago.launch.py
</pre></div>
</div>
</li>
<li><p>Open another terminal and launch the behavior tree:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>launch<span class="w"> </span>btcpp_ros2_samples_tiago_dual<span class="w"> </span>sample_bt_executor.launch.xml
</pre></div>
</div>
</li>
<li><p>Now send the goal with the desired mission in a third terminal:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ros2<span class="w"> </span>action<span class="w"> </span>send_goal<span class="w"> </span>/behavior_server<span class="w"> </span>btcpp_ros2_interfaces/action/ExecuteTree<span class="w"> </span><span class="s2">&quot;{target_tree: PickPlaceMission}&quot;</span>
</pre></div>
</div>
</li>
<li><p>This will run the pick and place mission.</p></li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="usage.html" class="btn btn-neutral float-left" title="Using TiagoDual" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hardware.html" class="btn btn-neutral float-right" title="Hardware" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Richard Fierkens.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>